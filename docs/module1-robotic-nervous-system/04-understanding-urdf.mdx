---
title: "4. Understanding URDF for Humanoid Robots"
sidebar_position: 4
chapter_type: "concept"
learning_goals:
  - "Understand the Unified Robot Description Format (URDF)"
  - "Learn how to model humanoid robot structure and kinematics"
  - "Define links, joints, and kinematic chains"
  - "Visualize robot models in RViz and simulation"
prerequisites:
  - "Basic understanding of 3D geometry and coordinate systems"
  - "ROS 2 fundamentals from previous chapters"
key_takeaways:
  - "URDF is an XML format for describing robot physical structure"
  - "Links represent rigid bodies, joints represent connections and motion"
  - "Kinematic trees define parent-child relationships between robot parts"
  - "URDF enables simulation, visualization, and motion planning for humanoids"
---

# Understanding URDF for Humanoid Robots

## Introduction: Describing Physical Structure

To simulate, visualize, or control a humanoid robot, ROS 2 needs a precise description of its physical structure. The **Unified Robot Description Format (URDF)** provides this description using XML.

<LearningGoals>
- Understand the Unified Robot Description Format (URDF)
- Learn how to model humanoid robot structure and kinematics
- Define links, joints, and kinematic chains
- Visualize robot models in RViz and simulation
</LearningGoals>

<Prerequisites>
- Basic understanding of 3D geometry and coordinate systems
- ROS 2 fundamentals from previous chapters
</Prerequisites>

## What is URDF?

URDF (Unified Robot Description Format) is an XML-based format that describes:

1. **Physical Properties**: Mass, inertia, collision geometry
2. **Visual Properties**: 3D meshes, colors, textures
3. **Kinematic Structure**: How parts connect and move
4. **Sensors and Actuators**: Cameras, LIDAR, motors

Think of URDF as the "blueprint" of your robot that ROS 2 uses for:
- **Simulation** (Gazebo, Isaac Sim)
- **Visualization** (RViz)
- **Motion Planning** (MoveIt)
- **Control** (ros2_control)

## Core URDF Concepts

### Links: Rigid Bodies

A **link** represents a rigid bodya part of the robot that doesn't deform. For a humanoid:
- Head, torso, upper arms, forearms, hands
- Thighs, shins, feet
- Individual finger segments

```xml
<link name="torso">
  <!-- Visual representation -->
  <visual>
    <geometry>
      <box size="0.3 0.4 0.6"/>  <!-- width, depth, height in meters -->
    </geometry>
    <material name="blue">
      <color rgba="0.0 0.0 1.0 1.0"/>
    </material>
  </visual>

  <!-- Collision geometry (usually simpler than visual) -->
  <collision>
    <geometry>
      <box size="0.3 0.4 0.6"/>
    </geometry>
  </collision>

  <!-- Physical properties -->
  <inertial>
    <mass value="15.0"/>  <!-- kg -->
    <inertia ixx="0.5" ixy="0.0" ixz="0.0"
             iyy="0.4" iyz="0.0" izz="0.3"/>
  </inertial>
</link>
```

### Joints: Connections and Motion

A **joint** connects two links and defines how they move relative to each other. Humanoid robots use several joint types:

| Joint Type | Description | Humanoid Example |
|------------|-------------|------------------|
| **revolute** | Rotates around one axis (limited range) | Elbow, knee, hip pitch |
| **continuous** | Rotates around one axis (unlimited) | Wheel (not typical for humanoids) |
| **prismatic** | Slides along one axis | Telescope joints (rare) |
| **fixed** | No movement | Sensor mounts |
| **floating** | 6 DOF (3 translation + 3 rotation) | Base of humanoid relative to world |

```xml
<joint name="left_shoulder" type="revolute">
  <!-- Parent link (closer to robot base) -->
  <parent link="torso"/>

  <!-- Child link (further from base) -->
  <child link="left_upper_arm"/>

  <!-- Joint origin relative to parent link -->
  <origin xyz="0.0 0.25 0.5" rpy="0 0 0"/>

  <!-- Axis of rotation (in joint's coordinate frame) -->
  <axis xyz="0 1 0"/>  <!-- Rotate around Y axis -->

  <!-- Joint limits -->
  <limit lower="-3.14" upper="3.14"  <!-- radians -->
         effort="100.0"                <!-- maximum torque (Nm) -->
         velocity="2.0"/>              <!-- max speed (rad/s) -->
</joint>
```

### The Kinematic Tree

Robots are organized as **kinematic trees** where:
- One link is the **base** (root)
- Each joint connects a parent link to a child link
- The structure must be a tree (no cycles)

For a humanoid:

```
                    torso (base)
                      /    \
              left_shoulder  right_shoulder
                    /              \
            left_upper_arm      right_upper_arm
                  /                    \
          left_elbow               right_elbow
               /                        \
      left_forearm                  right_forearm
```

## Building a Simple Humanoid Arm

Let's model a humanoid arm with shoulder, elbow, and wrist:

```xml
<?xml version="1.0"?>
<robot name="humanoid_arm">

  <!-- Base link (torso) -->
  <link name="torso">
    <visual>
      <geometry>
        <cylinder radius="0.15" length="0.6"/>
      </geometry>
      <material name="grey">
        <color rgba="0.5 0.5 0.5 1.0"/>
      </material>
    </visual>
    <inertial>
      <mass value="10.0"/>
      <inertia ixx="0.1" iyy="0.1" izz="0.05"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <!-- Shoulder joint (3 DOF typically, here simplified to 1 DOF) -->
  <joint name="shoulder_pitch" type="revolute">
    <parent link="torso"/>
    <child link="upper_arm"/>
    <origin xyz="0 0.2 0.5" rpy="0 0 0"/>
    <!-- Origin: torso center + 20cm to side + 50cm up -->
    <axis xyz="0 1 0"/>  <!-- Pitch axis (Y) -->
    <limit lower="-1.57" upper="3.14"  <!-- -90° to 180° -->
           effort="50.0" velocity="2.0"/>
  </joint>

  <!-- Upper arm link -->
  <link name="upper_arm">
    <visual>
      <geometry>
        <cylinder radius="0.05" length="0.3"/>
      </geometry>
      <origin xyz="0 0 -0.15" rpy="0 0 0"/>
      <!-- Shift down so joint is at top -->
      <material name="skin">
        <color rgba="0.95 0.8 0.7 1.0"/>
      </material>
    </visual>
    <inertial>
      <mass value="2.0"/>
      <inertia ixx="0.01" iyy="0.01" izz="0.001"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <!-- Elbow joint -->
  <joint name="elbow_pitch" type="revolute">
    <parent link="upper_arm"/>
    <child link="forearm"/>
    <origin xyz="0 0 -0.3" rpy="0 0 0"/>
    <!-- At bottom of upper arm -->
    <axis xyz="0 1 0"/>
    <limit lower="0" upper="2.44"  <!-- 0° to 140° (elbow bends one way) -->
           effort="30.0" velocity="2.0"/>
  </joint>

  <!-- Forearm link -->
  <link name="forearm">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.25"/>
      </geometry>
      <origin xyz="0 0 -0.125" rpy="0 0 0"/>
      <material name="skin"/>
    </visual>
    <inertial>
      <mass value="1.5"/>
      <inertia ixx="0.008" iyy="0.008" izz="0.0008"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <!-- Wrist joint -->
  <joint name="wrist_pitch" type="revolute">
    <parent link="forearm"/>
    <child link="hand"/>
    <origin xyz="0 0 -0.25" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57"  <!-- -90° to 90° -->
           effort="10.0" velocity="2.0"/>
  </joint>

  <!-- Hand link (simplified) -->
  <link name="hand">
    <visual>
      <geometry>
        <box size="0.08 0.12 0.02"/>
      </geometry>
      <origin xyz="0 0 -0.06" rpy="0 0 0"/>
      <material name="skin"/>
    </visual>
    <inertial>
      <mass value="0.4"/>
      <inertia ixx="0.001" iyy="0.001" izz="0.0005"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

</robot>
```

## Coordinate Frames and Transformations

Each link has its own **coordinate frame**. The `<origin>` tag in a joint specifies:

- `xyz`: Translation (x, y, z) from parent link's frame
- `rpy`: Rotation (roll, pitch, yaw) in radians

**Example**: If the shoulder joint origin is `xyz="0 0.2 0.5"`:
- 0m in X (forward)
- 0.2m in Y (left, assuming Y points left)
- 0.5m in Z (up)

from the torso's center.

### Visualization in RViz

Once you have a URDF, you can visualize it:

```bash
# Launch RViz with robot model
ros2 launch urdf_tutorial display.launch.py model:=my_humanoid.urdf
```

In RViz, you'll see:
- The robot's 3D structure
- Interactive sliders to move each joint
- Coordinate frames for each link

## Advanced URDF for Humanoid Simulation

### Collision vs Visual Geometry

- **Visual**: High-detail mesh for rendering (can be complex STL/DAE files)
- **Collision**: Simplified geometry for physics simulation (faster computation)

```xml
<link name="head">
  <!-- Detailed visual -->
  <visual>
    <geometry>
      <mesh filename="package://my_robot/meshes/head_detailed.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </visual>

  <!-- Simplified collision -->
  <collision>
    <geometry>
      <sphere radius="0.12"/>  <!-- Approximate head as sphere for collision -->
    </geometry>
  </collision>
</link>
```

### Inertial Properties

Accurate mass and inertia are crucial for realistic simulation:

```xml
<inertial>
  <origin xyz="0 0 0.05" rpy="0 0 0"/>  <!-- Center of mass offset -->
  <mass value="4.5"/>  <!-- kg -->
  <inertia ixx="0.01" ixy="0.0" ixz="0.0"
           iyy="0.01" iyz="0.0"
           izz="0.008"/>  <!-- kg·m² -->
</inertial>
```

For a box with dimensions (x, y, z) and mass m:
- `ixx = (m/12) * (y² + z²)`
- `iyy = (m/12) * (x² + z²)`
- `izz = (m/12) * (x² + y²)`

## Complete Humanoid Structure

A full humanoid URDF includes:

**Upper Body:**
- Torso
- Neck (1-2 DOF)
- Head (pan/tilt)
- 2 × Shoulder (3 DOF each)
- 2 × Elbow (1 DOF)
- 2 × Wrist (2-3 DOF)
- 2 × Hand (5-20+ DOF for fingers)

**Lower Body:**
- Hip (3 DOF × 2)
- Knee (1 DOF × 2)
- Ankle (2 DOF × 2)
- Foot (fixed or articulated)

**Total DOF**: 30-50+ for a complete humanoid

### URDF Tools

```bash
# Check URDF syntax
check_urdf my_robot.urdf

# Convert URDF to visual graph
urdf_to_graphiz my_robot.urdf

# Publish robot state to /robot_description topic
ros2 run robot_state_publisher robot_state_publisher --ros-args -p robot_description:="$(cat my_robot.urdf)"
```

<KeyTakeaways>
- URDF is an XML format for describing robot physical structure
- Links represent rigid bodies (arms, legs, torso), joints represent connections
- Kinematic trees define parent-child relationships between robot parts
- Accurate mass, inertia, and geometry enable realistic simulation
- URDF is used for visualization (RViz), simulation (Gazebo/Isaac), and motion planning
- Humanoid robots typically have 30-50+ degrees of freedom
</KeyTakeaways>

## Practical Exercise

<ExerciseBlock
  question="Design a simplified URDF for a humanoid robot's leg (hip, thigh, knee, shin, ankle, foot). Specify the joint types, axes of rotation, and reasonable joint limits. How many degrees of freedom does your leg have?"
  hints={[
    { title: "Hint 1", content: "The hip joint typically has 3 DOF: flexion/extension (pitch), abduction/adduction (roll), and internal/external rotation (yaw)." },
    { title: "Hint 2", content: "The knee is usually a simple 1 DOF revolute joint (bends one direction)." },
    { title: "Hint 3", content: "The ankle has 2 DOF: pitch (dorsiflexion/plantarflexion) and roll (inversion/eversion)." }
  ]}
  solution={
    <div>
      <p><strong>Simplified Humanoid Leg (6 DOF):</strong></p>
      <pre>{`
<robot name="humanoid_leg">
  <!-- Torso (base link) -->
  <link name="torso"/>

  <!-- Hip Pitch (flexion/extension) -->
  <joint name="hip_pitch" type="revolute">
    <parent link="torso"/>
    <child link="thigh"/>
    <origin xyz="0 0.1 -0.05"/>  <!-- Offset to side and down -->
    <axis xyz="0 1 0"/>
    <limit lower="-0.5" upper="2.0" effort="100" velocity="2"/>
  </joint>

  <!-- Thigh -->
  <link name="thigh">
    <visual>
      <geometry><cylinder radius="0.08" length="0.4"/></geometry>
      <origin xyz="0 0 -0.2"/>
    </visual>
    <inertial>
      <mass value="8.0"/>
      <inertia ixx="0.1" iyy="0.1" izz="0.01"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <!-- Knee -->
  <joint name="knee_pitch" type="revolute">
    <parent link="thigh"/>
    <child link="shin"/>
    <origin xyz="0 0 -0.4"/>
    <axis xyz="0 1 0"/>
    <limit lower="0" upper="2.35" effort="80" velocity="2"/>
  </joint>

  <!-- Shin -->
  <link name="shin">
    <visual>
      <geometry><cylinder radius="0.06" length="0.4"/></geometry>
      <origin xyz="0 0 -0.2"/>
    </visual>
    <inertial>
      <mass value="4.0"/>
      <inertia ixx="0.05" iyy="0.05" izz="0.005"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <!-- Ankle Pitch -->
  <joint name="ankle_pitch" type="revolute">
    <parent link="shin"/>
    <child link="foot"/>
    <origin xyz="0 0 -0.4"/>
    <axis xyz="0 1 0"/>
    <limit lower="-0.7" upper="0.7" effort="50" velocity="2"/>
  </joint>

  <!-- Foot -->
  <link name="foot">
    <visual>
      <geometry><box size="0.24 0.1 0.08"/></geometry>
      <origin xyz="0.08 0 -0.04"/>  <!-- Shift forward for heel-toe -->
    </visual>
    <inertial>
      <mass value="1.5"/>
      <inertia ixx="0.01" iyy="0.015" izz="0.01"
               ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>
</robot>
      `}</pre>
      <p><strong>Total DOF: 3</strong> (hip pitch + knee + ankle pitch). A complete leg would add hip roll, hip yaw, and ankle roll for 6 DOF total.</p>
    </div>
  }
/>

## Next Steps

In the next chapter, we'll learn about launch filesthe tool for starting multiple ROS 2 nodes with complex configurations, essential for managing humanoid robot systems.
